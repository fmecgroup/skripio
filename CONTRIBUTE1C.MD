# Description

Please follow this guide if you'd like to create your own [1C:Enterprise](https://www.1ci.com/developers/) **component** codebase that implements [JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript) codebase of a **component** or if you'd like to contribute to an existing [1C:Enterprise](https://www.1ci.com/developers/) **component** codebase.

# Skripio JS concepts

The following key concepts that are guaranteed to be supported in [JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript) codebase of every **skripio** component.

- Each **component** is guaranteed to be supplied as a single [JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript) bundle that contains all assets and dependencies compiled into one `HTML` file.
- Each **component** instantiates an object named `skripio` in the global scope and contains a set of **main methods** to instantiate a component object and then run it's methods.
- Each **component** will emit it's `async` **main method** responses into `<div id="init-response">`. You need to capture responses on element with `id` specified at component init stage. 
- Each **component method** will except one and only one parameter which is an object containing method arguments.
- Each **component method** is guaranteed to accept the `callback` attribute that will be returned within the response structure which can be used to link specific method call with specific response. 

## skripio namespace methods:

### getAssets
Loads any downloadable assets required for component to function.

### initObject
Instantiates a component object.

### runObjectMethod
Executes given **method** of a given **component** object.
Please see each component documentation for details on available component methods.

# Results of method calls
There are 2 possible types of responses that can be generated by component methods.
- `sync` - regular synchronous responses that are returned to the calling context as method completes it's execution.
- `async` - responses that are generated as a result of asynchronous code execution and are emitted into [1C:Enterprise](https://www.1ci.com/developers/) by triggering click event on a DOM element. Each component documentation will indicate those types of responses of it's methods.

# Response format
All responses despite of their type have the exact same structure:

```javascript
    { 
        callback: 'callback id', 
        code: 'response code', 
        payload: "Response payload" 
    }
```
- **callback** attribute is guaranteed to contain callback identifier passed to the method called.
- **code** attribute is guaranteed to contain [response code](https://github.com/fmecgroup/skripio-helper-response-emitter#codes).
- **payload** attribute is guaranteed to contain response payload massage that is expected by the method called.

# Quick steps

## Create HTML element
Create an HTML element and place all contents from `./dist/bundle.html` into it.

## Obtain downloadable assets
Run `skripio.getAssets()` method in case you need to obtain any downloadable assets.

## Instantiate component object
Run `skripio.initObject()` method to instantiate component object. Method will return `DOM element id` that will except async responses from that component.

## Call component methods
Run `skripio.runObjectMethod()` to execute given method of a given component like this:

```1C
Elements.HTMLField.Document.DefaultView.[skripio.[method](arguments)]);
```

## Listen to responses.
In order to listen to `async` responses listen to HTML field event `OnClick`
```1C
    &OnClient
    Procedure HTMLFieldOnClick(Element, EventData, Handler)
        Handler.Element.textContent // Contains response message
    EndProcedure
```